<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>주파수 재생기</title>
    <style>
        /* Inter 폰트 적용 */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(to bottom right, #a78bfa, #ec4899, #ef4444); /* from-purple-400 via-pink-500 to-red-500 */
            padding: 1rem; /* p-4 */
        }
        .container {
            background-color: #ffffff; /* bg-white */
            padding: 2rem; /* p-8 */
            border-radius: 1rem; /* rounded-2xl */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); /* shadow-2xl */
            width: 100%;
            max-width: 28rem; /* max-w-md */
            text-align: center;
        }
        h1 {
            font-size: 2.25rem; /* text-3xl */
            font-weight: bold; /* font-bold */
            color: #1f2937; /* text-gray-800 */
            margin-bottom: 1.5rem; /* mb-6 */
        }
        .form-group {
            margin-bottom: 1.5rem; /* mb-6 */
        }
        label {
            display: block;
            color: #374151; /* text-gray-700 */
            font-size: 1.125rem; /* text-lg */
            font-weight: 600; /* font-semibold */
            margin-bottom: 0.5rem; /* mb-2 */
        }
        select {
            width: 100%;
            padding: 0.75rem; /* p-3 */
            border: 1px solid #d1d5db; /* border border-gray-300 */
            border-radius: 0.5rem; /* rounded-lg */
            outline: none; /* focus:outline-none */
            color: #1f2937; /* text-gray-800 */
            font-size: 1.125rem; /* text-lg */
        }
        select:focus {
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5); /* focus:ring-2 focus:ring-blue-500 */
        }
        button {
            width: 100%;
            font-weight: bold; /* font-bold */
            padding: 0.75rem 1rem; /* py-3 px-4 */
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); /* shadow-md */
            transition: all 0.3s ease-in-out; /* transition duration-300 ease-in-out */
            transform: scale(1); /* transform hover:scale-105 */
            margin-bottom: 1rem; /* mb-4 */
        }
        button:hover {
            transform: scale(1.05);
        }
        #playButton {
            background-color: #2563eb; /* bg-blue-600 */
            color: #ffffff; /* text-white */
        }
        #playButton:hover {
            background-color: #1d4ed8; /* hover:bg-blue-700 */
        }
        #playSequenceButton {
            background-color: #16a34a; /* bg-green-600 */
            color: #ffffff; /* text-white */
        }
        #playSequenceButton:hover {
            background-color: #15803d; /* hover:bg-green-700 */
        }
        #currentFrequencyDisplay {
            margin-top: 1.5rem; /* mt-6 */
            font-size: 1.25rem; /* text-xl */
            color: #374151; /* text-gray-700 */
            font-weight: 500; /* font-medium */
        }
        #messageBox {
            margin-top: 1rem; /* mt-4 */
            padding: 0.75rem; /* p-3 */
            border-radius: 0.5rem; /* rounded-lg */
            font-size: 0.875rem; /* text-sm */
            color: #374151; /* text-gray-700 */
            background-color: #f3f4f6; /* bg-gray-100 */
            display: none; /* hidden */
        }
        #messageBox.bg-red-100 { background-color: #fee2e2; }
        #messageBox.text-red-700 { color: #b91c1c; }
        #messageBox.bg-green-100 { background-color: #dcfce7; }
        #messageBox.text-green-700 { color: #15803d; }
        #messageBox.bg-yellow-100 { background-color: #fffbeb; }
        #messageBox.text-yellow-700 { color: #b45309; }
        #messageBox.bg-gray-100 { background-color: #f3f4f6; }
        #messageBox.text-gray-700 { color: #374151; }
        #messageBox.text-sm { font-size: 0.875rem; } /* text-sm */
        #messageBox.text-xs { font-size: 0.75rem; } /* text-xs */
        #messageBox.show { display: block; } /* To make it visible */
    </style>
</head>
<body>
    <div class="container">
        <h1>주파수 재생기</h1>

        <div class="form-group">
            <label for="frequencySelect">단일 주파수 선택 (Hz):</label>
            <select id="frequencySelect">
                <!-- JavaScript가 여기에 옵션을 채웁니다 -->
            </select>
        </div>

        <button id="playButton">
            단일 소리 재생
        </button>

        <button id="playSequenceButton">
            연속 주파수 재생
        </button>

        <div id="currentFrequencyDisplay">
            선택된 주파수: 0 Hz
        </div>

        <div id="messageBox">
            <!-- 메시지가 여기에 표시됩니다 -->
        </div>
    </div>

    <script>
        // DOM elements
        const frequencySelect = document.getElementById('frequencySelect');
        const playButton = document.getElementById('playButton');
        const playSequenceButton = document.getElementById('playSequenceButton');
        const currentFrequencyDisplay = document.getElementById('currentFrequencyDisplay');
        const messageBox = document.getElementById('messageBox');

        // Web Audio API context variables
        let audioContext;
        let oscillator;
        let sequencePlaying = false;

        // Frequencies for the sequence playback
        const sequenceFrequencies = [9500, 10500, 11500, 12500, 13500, 14500, 15500, 16500, 17500];

        // Populate frequency dropdown options
        function populateFrequencyOptions() {
            frequencySelect.innerHTML = ''; // Clear existing options

            const specificFrequencies = [20, 100, 500];
            specificFrequencies.forEach(freq => {
                const option = document.createElement('option');
                option.value = freq;
                option.textContent = `${freq} Hz`;
                frequencySelect.appendChild(option);
            });

            for (let freq = 1000; freq <= 20000; freq += 1000) {
                const option = document.createElement('option');
                option.value = freq;
                option.textContent = `${freq} Hz`;
                frequencySelect.appendChild(option);
            }
            frequencySelect.value = 1000;
            updateCurrentFrequencyDisplay();
        }

        // Update display for current selected/playing frequency
        function updateCurrentFrequencyDisplay(frequency = frequencySelect.value) {
            currentFrequencyDisplay.textContent = `선택된 주파수: ${frequency} Hz`;
        }

        // Show messages in the message box
        function showMessage(message, type = 'info', isSmallFont = false) {
            messageBox.textContent = message;
            messageBox.classList.remove('bg-red-100', 'text-red-700', 'bg-green-100', 'text-green-700', 'bg-yellow-100', 'text-yellow-700', 'bg-gray-100', 'text-gray-700', 'text-sm', 'text-xs');
            messageBox.classList.add('show'); // Ensure message box is visible

            if (type === 'error') {
                messageBox.classList.add('bg-red-100', 'text-red-700');
            } else if (type === 'success') {
                messageBox.classList.add('bg-green-100', 'text-green-700');
                if (isSmallFont) {
                    messageBox.classList.add('text-sm');
                }
            } else if (type === 'warning') {
                messageBox.classList.add('bg-yellow-100', 'text-yellow-700');
            } else {
                messageBox.classList.add('bg-gray-100', 'text-gray-700');
            }
            // Messages are now persistent as per previous request
        }

        // Function to play a single sound
        async function playSingleSound(frequency) {
            if (!audioContext) {
                try {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    showMessage('Web Audio API를 지원하지 않는 브라우저입니다.', 'error');
                    console.error('Web Audio API not supported:', e);
                    return;
                }
            }

            if (oscillator) {
                oscillator.stop();
                oscillator.disconnect();
            }

            oscillator = audioContext.createOscillator();
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);

            const gainNode = audioContext.createGain();
            gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.start();
            updateCurrentFrequencyDisplay(frequency);
            showMessage(`주파수 ${frequency} Hz 재생 중...`, 'info');

            oscillator.stop(audioContext.currentTime + 1.5);
            oscillator.onended = () => {
                if (!sequencePlaying) {
                    showMessage(`주파수 ${frequency} Hz 재생 완료.`, 'success');
                }
                oscillator.disconnect();
                oscillator = null;
            };
        }

        // Function to play the sequence of frequencies
        async function playFrequencySequence() {
            if (sequencePlaying) {
                showMessage('이미 연속 재생 중입니다. 잠시 기다려주세요.', 'warning');
                return;
            }

            sequencePlaying = true;
            playSequenceButton.disabled = true;
            playButton.disabled = true;

            showMessage('연속 주파수 재생 시작...', 'info');

            let index = 0;
            const playNextFrequency = () => {
                if (index < sequenceFrequencies.length) {
                    const freq = sequenceFrequencies[index];
                    playSingleSound(freq);
                    index++;
                    setTimeout(playNextFrequency, 1500 + 100);
                } else {
                    showMessage('연속 주파수 재생 완료!', 'success', true);
                    sequencePlaying = false;
                    playSequenceButton.disabled = false;
                    playButton.disabled = false;
                    updateCurrentFrequencyDisplay();
                }
            };

            playNextFrequency();
        }

        // Event listeners
        playButton.addEventListener('click', () => playSingleSound(parseFloat(frequencySelect.value)));
        playSequenceButton.addEventListener('click', playFrequencySequence);
        frequencySelect.addEventListener('change', updateCurrentFrequencyDisplay);

        // Populate frequency options on page load
        window.onload = populateFrequencyOptions;
    </script>
</body>
</html>
